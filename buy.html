<!DOCTYPE html>
<html lang="en">
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<head>
  <title>shop1+</title>
  <link rel="stylesheet" href="buy.css">
  <!-- <script src="assest/oneplus.js"></script> -->
</head>

<body>
  <header id="header"></header>

  <main class="container">

    <div class="left-column" id="productimage">
      <!-- <img data-image="red" class="active" src="images/oneplus.png" alt="">
              <img data-image="black"  src="images/grey.png" alt=""> -->
    </div>


    <div class="right-column">

      <div class="product-description">
        <!-- <span>oneplus</span>
                <h1>Nord 2</h1>
                <p> Pretty much Everything You Could Ask For</p> -->
      </div>

      <div class="product-configuration">

        <div class="product-color">
          <span>Color</span>

          <div class="color-choose">
            <div>
              <input data-image="blue" type="radio" id="blue" name="color" value="blue" checked>
              <label for="blue"><span></span></label>
            </div>
            <div>
              <input data-image="black" type="radio" id="black" name="color" value="black">
              <label for="black"><span></span></label>
            </div>

          </div>

        </div>

        <div class="product-config">
          <span>varient</span>

          <div class="product-choose">
            <button>6+128</button>
            <button>8+128</button>
            <button>12+256</button>
          </div>

          <!-- <a href="#">Terms and Conditions</a> -->
        </div>
      </div>

      <div class="product-price">
        <span>â‚¹34,999 </span>
      </div>
      <button onclick="addProduct()" class="cart-btn">Buy Now</button>
      <!-- <input type="submit" onclick="addProduct()"> -->

    </div>

    <!-- <div>
      <table>
        <tr>
          <th>Components</th>
          <th>Specifications</th>
        </tr>

        <tr>
          <td></td>
        </tr>
      </table>
    </div> -->

    <script>
      console.log(window.location.search.substr(1));
      const Params = new URLSearchParams(window.location.search.substr(1));
      console.log(Params);

      let product = Params.get("productName");
      let productUrl = Params.get("productUrl");
      let productConfiguration = Params.get("productConfiguration");
      let productBrand = Params.get("productBrand");
      let productPrice = Params.get("productPrice");

      console.log("product :", product);
      console.log("productUrl :", productUrl);
      console.log("productConfiguration :", productConfiguration);
      console.log("productBrand :", productBrand);
      console.log("productPrice :", productPrice);

      document.querySelector(".product-description").innerHTML = `
            <span>${product}</span> 
                <h1>${productBrand}</h1>
                <p> ${productConfiguration}</p>
                `;

      document.querySelector("#productimage").innerHTML = `
                <img data-image="red" class="active" src="images/${productUrl}" alt="no image">
                `;
      document.querySelector(".product-price").innerHTML = `
         <span>${productPrice}</span>
         `;

      // adding product to cart
      function addProduct() {


        console.log("check :", product);

        let addProductStr = localStorage.getItem("cartProduct");
        let cartProduct = addProductStr != null ? JSON.parse(addProductStr) : [];
        var qty = 1;


        // If item already exist, update the quantity
        let index = cartProduct.findIndex(cartProduct => cartProduct.Id == id);
        // alert(index);
        console.log(index);
        if (index != -1) {
          let productObj = cartProduct[index];
          console.log(productObj);
          productObj.Qty++;
          cartProduct[index] = productObj;

        }
        else {
          // if item not exist, add new item to cart
          console.log("bharathi");
          let productObj = {
            "productName": product,
            "productUrl": productUrl,
            "productConfiguration": productConfiguration,
            "productBrand": productBrand,
            "productPrice": productPrice
          };
          console.log(productObj);
          cartProduct.push(productObj);
        }

        localStorage.setItem("productElements", JSON.stringify(cartProduct));

        let userData = localStorage.getItem("LOGGED_IN_USER");
        let user = JSON.parse(userData);
        console.log(user);
          if (user == null) {
            console.log("user : ", user);
            alert("plz login");
            window.location.href = "login.html";
          }
          else {
            
            console.log("user : ", user);
            alert("done");
            window.location.href = "cart.html";
          }
      }

    </script>

<script src="assest/jquery.min.js"></script>

<script>
   $("#header").load("header.html");
 </script>
 
  </main>
</body>

</html>